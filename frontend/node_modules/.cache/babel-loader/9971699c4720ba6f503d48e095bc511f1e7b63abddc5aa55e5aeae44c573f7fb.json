{"ast":null,"code":"import React,{useContext}from\"react\";import{Col,ListGroup,Row}from\"react-bootstrap\";import{useDispatch,useSelector}from\"react-redux\";import{AppContext}from\"../context/appContext\";import\"./Sidebar.css\";import{addNotifications,resetNotifications}from\"../features/userSlice\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Sidebar(){var user=useSelector(function(state){return state.user;});var dispatch=useDispatch();var _useContext=useContext(AppContext),socket=_useContext.socket,setMembers=_useContext.setMembers,members=_useContext.members,setCurrentRoom=_useContext.setCurrentRoom,privateMemberMsg=_useContext.privateMemberMsg,rooms=_useContext.rooms,setPrivateMemberMsg=_useContext.setPrivateMemberMsg,currentRoom=_useContext.currentRoom;function joinRoom(room){var isPublic=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(!user){return alert(\"Please login\");}socket.emit(\"join-room\",room,currentRoom);setCurrentRoom(room);if(isPublic){setPrivateMemberMsg(null);}//dispatch for notifications\ndispatch(resetNotifications(room));}socket.off(\"notifications\").on(\"notifications\",function(room){if(currentRoom!=room)dispatch(addNotifications(room));});socket.off(\"new-user\").on(\"new-user\",function(payload){setMembers(payload);});function orderIds(id1,id2){if(id1>id2){return id1+\"-\"+id2;}else{return id2+\"-\"+id1;}}function handlePrivateMemberMsg(member){setPrivateMemberMsg(member);var roomId=orderIds(user._id,member._id);joinRoom(roomId,false);}if(!user){return/*#__PURE__*/_jsx(_Fragment,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Available rooms\"}),/*#__PURE__*/_jsx(ListGroup,{children:rooms.map(function(room,idx){return/*#__PURE__*/_jsxs(ListGroup.Item,{onClick:function onClick(){return joinRoom(room);},active:room===currentRoom,style:{cursor:\"pointer\",display:\"flex\",justifyContent:\"space-between\"},children:[room,currentRoom!==room&&/*#__PURE__*/_jsx(\"span\",{className:\"badge rounded-pill bg-primary\",children:user.newMessages[room]})]},idx);})}),/*#__PURE__*/_jsx(\"h2\",{children:\"Members\"}),members.map(function(member){return/*#__PURE__*/_jsx(ListGroup.Item,{style:{cursor:\"pointer\"},active:(privateMemberMsg===null||privateMemberMsg===void 0?void 0:privateMemberMsg._id)==(member===null||member===void 0?void 0:member._id),onClick:function onClick(){return handlePrivateMemberMsg(member);},disabled:member._id===user._id,children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{xs:2,className:\"member-status\",children:[/*#__PURE__*/_jsx(\"img\",{src:member.picture,className:\"member-status-img\"}),member.status==\"online\"?/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-circle sidebar-online-status\"}):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-circle sidebar-offline-status\"})]}),/*#__PURE__*/_jsxs(Col,{xs:9,children:[member.name,member._id===(user===null||user===void 0?void 0:user._id)&&\" (You)\",member.status==\"offline\"&&\" (Offline)\"]}),/*#__PURE__*/_jsx(Col,{xs:1,children:/*#__PURE__*/_jsx(\"span\",{className:\"badge rounded-pill bg-primary\",children:user.newMessages[orderIds(member._id,user._id)]})})]})},member.id);})]});}export default Sidebar;","map":{"version":3,"names":["React","useContext","Col","ListGroup","Row","useDispatch","useSelector","AppContext","addNotifications","resetNotifications","Sidebar","user","state","dispatch","socket","setMembers","members","setCurrentRoom","privateMemberMsg","rooms","setPrivateMemberMsg","currentRoom","joinRoom","room","isPublic","alert","emit","off","on","payload","orderIds","id1","id2","handlePrivateMemberMsg","member","roomId","_id","map","idx","cursor","display","justifyContent","newMessages","picture","status","name","id"],"sources":["/home/user/app/e11/Chat-App/frontend/src/components/Sidebar.js"],"sourcesContent":["import React, { useContext } from \"react\";\nimport { Col, ListGroup, Row } from \"react-bootstrap\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { AppContext } from \"../context/appContext\";\nimport \"./Sidebar.css\";\nimport { addNotifications, resetNotifications } from \"../features/userSlice\";\n\nfunction Sidebar() {\n  const user = useSelector((state) => state.user);\n  const dispatch = useDispatch();\n  const {\n    socket,\n    setMembers,\n    members,\n    setCurrentRoom,\n    // setRooms,\n    privateMemberMsg,\n    rooms,\n    setPrivateMemberMsg,\n    currentRoom,\n  } = useContext(AppContext);\n\n\n  function joinRoom(room, isPublic = true) {\n    if (!user) {\n      return alert(\"Please login\");\n    }\n    socket.emit(\"join-room\", room, currentRoom);\n    setCurrentRoom(room);\n\n    if (isPublic) {\n      setPrivateMemberMsg(null);\n    }\n    //dispatch for notifications\n    dispatch(resetNotifications(room));\n  }\n  socket.off(\"notifications\").on(\"notifications\", (room) => {\n    if (currentRoom != room) dispatch(addNotifications(room));\n  });\n  \n\n  \n  socket.off(\"new-user\").on(\"new-user\", (payload) => {\n    setMembers(payload);\n  });\n\n  function orderIds(id1, id2) {\n    if (id1 > id2) {\n      return id1 + \"-\" + id2;\n    } else {\n      return id2 + \"-\" + id1;\n    }\n  }\n\n  function handlePrivateMemberMsg(member) {\n    setPrivateMemberMsg(member);\n    const roomId = orderIds(user._id, member._id);\n    joinRoom(roomId, false);\n  }\n\n  if (!user) {\n    return <></>;\n  }\n  return (\n    <>\n      <h2>Available rooms</h2>\n      <ListGroup>\n        {rooms.map((room, idx) => (\n          <ListGroup.Item\n            key={idx}\n            onClick={() => joinRoom(room)}\n            active={room === currentRoom}\n            style={{\n              cursor: \"pointer\",\n              display: \"flex\",\n              justifyContent: \"space-between\",\n            }}\n          >\n            {room}\n            {currentRoom !== room && <span className=\"badge rounded-pill bg-primary\">{user.newMessages[room]}</span>}\n          </ListGroup.Item>\n        ))}\n      </ListGroup>\n      <h2>Members</h2>\n      {members.map((member) => (\n        <ListGroup.Item\n          key={member.id}\n          style={{ cursor: \"pointer\" }}\n          active={privateMemberMsg?._id == member?._id}\n          onClick={() => handlePrivateMemberMsg(member)}\n          disabled={member._id === user._id}\n        >\n           <Row>\n                        <Col xs={2} className=\"member-status\">\n                            <img src={member.picture} className=\"member-status-img\" />\n                            {member.status == \"online\" ? <i className=\"fas fa-circle sidebar-online-status\"></i> : <i className=\"fas fa-circle sidebar-offline-status\"></i>}\n                        </Col>\n                        <Col xs={9}>\n                            {member.name}\n                            {member._id === user?._id && \" (You)\"}\n                            {member.status == \"offline\" && \" (Offline)\"}\n                        </Col>\n                        <Col xs={1}>\n                            <span className=\"badge rounded-pill bg-primary\">{user.newMessages[orderIds(member._id, user._id)]}</span>\n                        </Col>\n                    </Row>\n        </ListGroup.Item>\n      ))}\n    </>\n  );\n}\n\nexport default Sidebar;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}