{"ast":null,"code":"import _slicedToArray from\"/home/user/app/e11/Chat-App/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useRef,useState,useEffect}from\"react\";import{Button,Col,Form,Row}from\"react-bootstrap\";import{useSelector}from\"react-redux\";import{AppContext}from\"../context/appContext\";import\"./MessageForm.css\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function MessageForm(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var user=useSelector(function(state){return state.user;});var _useContext=useContext(AppContext),socket=_useContext.socket,currentRoom=_useContext.currentRoom,setMessages=_useContext.setMessages,messages=_useContext.messages,privateMemberMsg=_useContext.privateMemberMsg;var messageEndRef=useRef(null);useEffect(function(){scrollToBottom();},[messages]);function getFormattedDate(){var date=new Date();var year=date.getFullYear();var month=(1+date.getMonth()).toString();month=month.length>1?month:\"0\"+month;var day=date.getDate().toString();day=day.length>1?day:\"0\"+day;return month+\"/\"+day+\"/\"+year;}//   function handleSubmit(e) {\n//     e.preventDefault();\n//   }\nfunction scrollToBottom(){var _messageEndRef$curren;(_messageEndRef$curren=messageEndRef.current)===null||_messageEndRef$curren===void 0?void 0:_messageEndRef$curren.scrollIntoView({behavior:\"smooth\"});}var todayDate=getFormattedDate();socket.off(\"room-messages\").on(\"room-messages\",function(roomMessages){setMessages(roomMessages);});function handleSubmit(e){e.preventDefault();if(!message)return;var today=new Date();var minutes=today.getMinutes()<10?\"0\"+today.getMinutes():today.getMinutes();var time=today.getHours()+\":\"+minutes;var roomId=currentRoom;socket.emit(\"message-room\",roomId,message,user,time,todayDate);setMessage(\"\");}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"messages-output\",children:[user&&!(privateMemberMsg!==null&&privateMemberMsg!==void 0&&privateMemberMsg._id)&&/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-info\",children:[\"You are in the \",currentRoom,\" room\"]}),user&&(privateMemberMsg===null||privateMemberMsg===void 0?void 0:privateMemberMsg._id)&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info conversation-info\",children:/*#__PURE__*/_jsxs(\"div\",{children:[\"Your conversation with \",privateMemberMsg.name,\" \",/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:privateMemberMsg.picture,className:\"conversation-profile-pic\"})]})})}),!user&&/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:\"Please login\"}),user&&messages.map(function(_ref,idx){var date=_ref._id,messagesByDate=_ref.messagesByDate;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"alert alert-info text-center message-date-indicator\",children:date}),messagesByDate===null||messagesByDate===void 0?void 0:messagesByDate.map(function(_ref2,msgIdx){var content=_ref2.content,time=_ref2.time,sender=_ref2.from;return/*#__PURE__*/_jsx(\"div\",{className:(sender===null||sender===void 0?void 0:sender.email)===(user===null||user===void 0?void 0:user.email)?\"message\":\"incoming-message\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"message-inner\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center mb-3\",children:[/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:sender.picture,style:{width:35,height:35,objectFit:\"cover\",borderRadius:\"50%\",marginRight:10}}),/*#__PURE__*/_jsx(\"p\",{className:\"message-sender\",children:sender._id===(user===null||user===void 0?void 0:user._id)?\"You\":sender.name})]}),/*#__PURE__*/_jsx(\"p\",{className:\"message-content\",children:content}),/*#__PURE__*/_jsx(\"p\",{className:\"message-timestamp-left\",children:time})]})},msgIdx);})]},idx);}),/*#__PURE__*/_jsx(\"div\",{ref:messageEndRef})]}),/*#__PURE__*/_jsx(Form,{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:11,children:/*#__PURE__*/_jsx(Form.Group,{children:/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Your message\",disabled:!user,value:message,onChange:function onChange(e){return setMessage(e.target.value);}})})}),/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Button,{variant:\"primary\",type:\"submit\",style:{width:\"100%\",backgroundColor:\"orange\"},disabled:!user,children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-paper-plane\"})})})]})})]});}export default MessageForm;","map":{"version":3,"names":["React","useContext","useRef","useState","useEffect","Button","Col","Form","Row","useSelector","AppContext","MessageForm","message","setMessage","user","state","socket","currentRoom","setMessages","messages","privateMemberMsg","messageEndRef","scrollToBottom","getFormattedDate","date","Date","year","getFullYear","month","getMonth","toString","length","day","getDate","current","scrollIntoView","behavior","todayDate","off","on","roomMessages","handleSubmit","e","preventDefault","today","minutes","getMinutes","time","getHours","roomId","emit","_id","name","picture","map","idx","messagesByDate","msgIdx","content","sender","from","email","width","height","objectFit","borderRadius","marginRight","target","value","backgroundColor"],"sources":["/home/user/app/e11/Chat-App/frontend/src/components/MessageForm.js"],"sourcesContent":["import React, { useContext, useRef, useState, useEffect } from \"react\";\nimport { Button, Col, Form, Row } from \"react-bootstrap\";\nimport { useSelector } from \"react-redux\";\nimport { AppContext } from \"../context/appContext\";\nimport \"./MessageForm.css\";\n\nfunction MessageForm() {\n  const [message, setMessage] = useState(\"\");\n  const user = useSelector((state) => state.user);\n  const { socket, currentRoom, setMessages, messages, privateMemberMsg } =\n    useContext(AppContext);\n  const messageEndRef = useRef(null);\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  function getFormattedDate() {\n    const date = new Date();\n    const year = date.getFullYear();\n    let month = (1 + date.getMonth()).toString();\n\n    month = month.length > 1 ? month : \"0\" + month;\n    let day = date.getDate().toString();\n\n    day = day.length > 1 ? day : \"0\" + day;\n\n    return month + \"/\" + day + \"/\" + year;\n  }\n\n  //   function handleSubmit(e) {\n  //     e.preventDefault();\n  //   }\n  function scrollToBottom() {\n    messageEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }\n\n  const todayDate = getFormattedDate();\n\n  socket.off(\"room-messages\").on(\"room-messages\", (roomMessages) => {\n    setMessages(roomMessages);\n  });\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    if (!message) return;\n    const today = new Date();\n    const minutes =\n      today.getMinutes() < 10 ? \"0\" + today.getMinutes() : today.getMinutes();\n    const time = today.getHours() + \":\" + minutes;\n    const roomId = currentRoom;\n    socket.emit(\"message-room\", roomId, message, user, time, todayDate);\n    setMessage(\"\");\n  }\n  return (\n    <>\n      <div className='messages-output'>\n        {user && !privateMemberMsg?._id && (\n          <div className='alert alert-info'>\n            You are in the {currentRoom} room\n          </div>\n        )}\n        {user && privateMemberMsg?._id && (\n          <>\n            <div className='alert alert-info conversation-info'>\n              <div>\n                Your conversation with {privateMemberMsg.name}{\" \"}\n                <img\n                  alt=''\n                  src={privateMemberMsg.picture}\n                  className='conversation-profile-pic'\n                />\n              </div>\n            </div>\n          </>\n        )}\n        {!user && <div className='alert alert-danger'>Please login</div>}\n\n        {user &&\n          messages.map(({ _id: date, messagesByDate }, idx) => (\n            <div key={idx}>\n              <p className='alert alert-info text-center message-date-indicator'>\n                {date}\n              </p>\n              {messagesByDate?.map(\n                ({ content, time, from: sender }, msgIdx) => (\n                  <div\n                    className={\n                      sender?.email === user?.email\n                        ? \"message\"\n                        : \"incoming-message\"\n                    }\n                    key={msgIdx}\n                  >\n                    <div className='message-inner'>\n                      <div className='d-flex align-items-center mb-3'>\n                        <img\n                          alt=''\n                          src={sender.picture}\n                          style={{\n                            width: 35,\n                            height: 35,\n                            objectFit: \"cover\",\n                            borderRadius: \"50%\",\n                            marginRight: 10,\n                          }}\n                        />\n                        <p className='message-sender'>\n                          {sender._id === user?._id ? \"You\" : sender.name}\n                        </p>\n                      </div>\n                      <p className='message-content'>{content}</p>\n                      <p className='message-timestamp-left'>{time}</p>\n                    </div>\n                  </div>\n                )\n              )}\n            </div>\n          ))}\n        <div ref={messageEndRef} />\n      </div>\n      <Form onSubmit={handleSubmit}>\n        <Row>\n          <Col md={11}>\n            <Form.Group>\n              <Form.Control\n                type='text'\n                placeholder='Your message'\n                disabled={!user}\n                value={message}\n                onChange={(e) => setMessage(e.target.value)}\n              ></Form.Control>\n            </Form.Group>\n          </Col>\n          <Col md={1}>\n            <Button\n              variant='primary'\n              type='submit'\n              style={{ width: \"100%\", backgroundColor: \"orange\" }}\n              disabled={!user}\n            >\n              <i className='fas fa-paper-plane'></i>\n            </Button>\n          </Col>\n        </Row>\n      </Form>\n    </>\n  );\n}\n\nexport default MessageForm;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}